{% extends "bootstrap/base.html" %}

{% block styles %}
    {{ super() }}
{#
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
#}
    <style>
        body {
            margin-top: 60px;
        }
    </style>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
        var CONFIG = {
            'stats_url': "{{ url_for('api.stats', _external=True) }}",
            'action_url': "{{ url_for('api.action', _external=True) }}",
        };
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}

{% block title %}BS Monitor{% endblock %}

{% block navbar %}
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">
                    <i class="fa fa-lemon"></i>
                    BS Monitor
                </a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li>
                        <a>
                            <strong>Server:</strong>
                            <span class="server-status">
                                <span class="label label-danger sstat" data-type="toggle" data-stat="!connected">Disconnected</span>
                                <span class="label label-success sstat" data-type="toggle" data-stat="connected" style="display: none">Connected</span>
                            </span>
                            <span class="server-info sstat" data-type="show" data-stat="connected" style="display: none;">
                                Beanstalk v<span class="sstat" data-type="target" data-stat="version"></span>
                                <span class="sstat" data-type="target" data-stat="hostname"></span>#<span class="sstat" data-type="target" data-stat="id"></span>
                                <span class="label label-warning sstat" data-type="toggle" data-stat="draining" style="display: none;">Draining</span>
                            </span>
                        </a>
                    </li>
                </ul>
                {#
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">foo</a></li>
                </ul>
                #}
            </div><!--/.nav-collapse -->
        </div>
    </nav>
{% endblock %}

{% block content %}
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="col-xs-12">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Buried</th>
                            <th>Delayed</th>
                            <th>Ready</th>
                            <th>Reserved</th>
                            <th>Urgent</th>
                            <th>Connections</th>
                            <th>Producers</th>
                            <th>Workers</th>
                            <th>Waiting</th>
                            <th>Tubes</th>
                            <th>Timeouts</th>
                            <th>Total Connections</th>
                            <th>Total Jobs</th>
                            <th>Uptime</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="sstat" data-type="target" data-stat="current-jobs-buried">0</td>
                            <td class="sstat" data-type="target" data-stat="current-jobs-delayed">0</td>
                            <td class="sstat" data-type="target" data-stat="current-jobs-ready">0</td>
                            <td class="sstat" data-type="target" data-stat="current-jobs-reserved">0</td>
                            <td class="sstat" data-type="target" data-stat="current-jobs-urgent">0</td>
                            <td class="sstat" data-type="target" data-stat="current-connections">0</td>
                            <td class="sstat" data-type="target" data-stat="current-producers">0</td>
                            <td class="sstat" data-type="target" data-stat="current-workers">0</td>
                            <td class="sstat" data-type="target" data-stat="current-waiting">0</td>
                            <td class="sstat" data-type="target" data-stat="current-tubes">0</td>
                            <td class="sstat" data-type="target" data-stat="job-timeouts">0</td>
                            <td class="sstat" data-type="target" data-stat="total-connections">0</td>
                            <td class="sstat" data-type="target" data-stat="total-jobs">0</td>
                            <td class="sstat" data-type="target" data-stat="uptime">0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row-fluid">
            <div class="col-xs-12">
                <table class="table table-striped" id="tube-stats">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Buried</th>
                            <th>Delayed</th>
                            <th>Ready</th>
                            <th>Reserved</th>
                            <th>Urgent</th>
                            <th>Using</th>
                            <th>Waiting</th>
                            <th>Watching</th>
                            <th>Pause</th>
                            <th>Pause Time Left</th>
                            <th>Total Jobs</th>
                            <th>&nbsp;</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="tstat-row template" data-tube="" style="display: none;">
                            <td class="tstat" data-stat="name"></td>
                            <td class="tstat" data-stat="current-jobs-buried"></td>
                            <td class="tstat" data-stat="current-jobs-delayed"></td>
                            <td class="tstat" data-stat="current-jobs-ready"></td>
                            <td class="tstat" data-stat="current-jobs-reserved"></td>
                            <td class="tstat" data-stat="current-jobs-urgent"></td>
                            <td class="tstat" data-stat="current-using"></td>
                            <td class="tstat" data-stat="current-waiting"></td>
                            <td class="tstat" data-stat="current-watching"></td>
                            <td class="tstat" data-stat="pause"></td>
                            <td class="tstat" data-stat="pause-time-left"></td>
                            <td class="tstat" data-stat="total-jobs"></td>
                            <td>
                                <a class="btn btn-xs btn-warning tube-action" data-action="pause" data-count="0" data-askText="Pause {tube} for how many seconds?" title="Pause">
                                    <span class="glyphicon glyphicon-pause"></span>
                                </a>
                                <a class="btn btn-xs btn-warning tube-action" data-action="pause" data-count="8640000" title="Stop">
                                    <span class="glyphicon glyphicon-stop"></span>
                                </a>
                                <a class="btn btn-xs btn-success tube-action" data-action="pause" data-count="0" title="Resume">
                                    <span class="glyphicon glyphicon-play"></span>
                                </a>
                                <a class="btn btn-xs btn-default tube-action" data-action="bury" data-count="0" data-askText="Bury how many jobs in {tube}?" title="Bury">
                                    <span class="glyphicon glyphicon-save"></span>
                                </a>
                                <a class="btn btn-xs btn-default tube-action" data-action="bury" data-count="-1" title="Bury All">
                                    <span class="glyphicon glyphicon-save"></span>
                                    all
                                </a>
                                <a class="btn btn-xs btn-primary tube-action" data-action="kick" data-count="0" data-askText="Kick how many jobs in {tube}?" title="Kick">
                                    <span class="glyphicon glyphicon-open"></span>
                                </a>
                                <a class="btn btn-xs btn-primary tube-action" data-action="kick" data-count="1" title="Kick One">
                                    <span class="glyphicon glyphicon-open"></span>
                                    1
                                </a>
                                <a class="btn btn-xs btn-primary tube-action" data-action="kick" data-count="-1" data-confirmText="Are you sure you want to kick all jobs in {tube}?" title="Kick All">
                                    <span class="glyphicon glyphicon-open"></span>
                                    all
                                </a>
                                <a class="btn btn-xs btn-danger tube-action" data-action="purge" data-count="-1" data-confirmText="Are you sure you want to purge all jobs in {tube}?" title="Purge All">
                                    <span class="glyphicon glyphicon-trash"></span>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}
